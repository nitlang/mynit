<!DOCTYPE html>
<html lang='en' ng-app='ng-example'>
	<head>
		<base href='/'>
		<title>Popcorn Basic Authentification</title>
		<link rel="stylesheet" crossorigin="anonymous"
		  href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
		  integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u">
	</head>
	<body ng-controller='AuthCtrl as vm' class='container'>
		<h1>Popcorn Basic Authentification</h1>

		<div ng-if='vm.emailStatus == "success"'>
			<h1 class='text-success'>Email successfully activated</h1>
		</div>
		<div ng-if='vm.emailStatus && vm.emailStatus != "success"'>
			<h1 class='text-danger'>Error while validating your email: {{vm.emailStatus}}</h1>
		</div>

		<div ng-if='!vm.user'>
			<p class='text-danger lead'>You are not authenticated</p>
			<div class='container'>
				<div class='col-xs-6'>
					<h3>Signin</h3>
					<div class='form-group' ng-class='{"has-error": vm.signinErrors.login}'>
						<label class='control-label'>Login</label>
						<input name='login' type='text' class='form-control' ng-model='vm.signinForm.login'>
						<span class='help-block' ng-repeat='err in vm.signinErrors.login'>
							{{err}}
						</span>
					</div>
					<div class='form-group' ng-class='{"has-error": vm.signinErrors.password1}'>
						<label class='control-label'>Password</label>
						<input name='password1' type='password' class='form-control' ng-model='vm.signinForm.password1'>
						<span class='help-block' ng-repeat='err in vm.signinErrors.password1'>
							{{err}}
						</span>
					</div>
					<div class='form-group' ng-class='{"has-error": vm.signinErrors.password2}'>
						<label class='control-label'>Repeat password</label>
						<input name='password2' type='password' class='form-control' ng-model='vm.signinForm.password2'>
						<span class='help-block' ng-repeat='err in vm.signinErrors.password2'>
							{{err}}
						</span>
					</div>
					<div class='form-group' ng-class='{"has-error": vm.signinErrors.email}'>
						<label class='control-label'>Email</label>
						<input name='email' type='text' class='form-control' ng-model='vm.signinForm.email'>
						<span class='help-block' ng-repeat='err in vm.signinErrors.email'>
							{{err}}
						</span>
					</div>
					<button class='btn btn-primary' ng-click='vm.signin()'>Signin</button>
				</div>
				<div class='col-xs-6'>
					<h3>Login</h3>
					<div class='form-group' ng-class='{"has-error": vm.loginErrors.login}'>
						<label class='control-label'>Login</label>
						<input name='login' type='text' class='form-control' ng-model='vm.loginForm.login'>
						<span class='help-block' ng-repeat='err in vm.loginErrors.login'>
							{{err}}
						</span>
					</div>
					<div class='form-group' ng-class='{"has-error": vm.loginErrors.password}'>
						<label class='control-label'>Password</label>
						<input name='password' type='password' class='form-control' ng-model='vm.loginForm.password'>
						<span class='help-block' ng-repeat='err in vm.loginErrors.password'>
							{{err}}
						</span>
					</div>
					<span class='text-danger'>{{vm.loginErrors.credentials}}</span>
					<button class='btn btn-primary' ng-click='vm.login()'>Login</button>
					<button class='btn btn-default' type='button' data-toggle='modal' data-target='#lostPasswordModal'>
						  I forgot my password.
					</button>
				</div>
			</div>
		</div>

		<div ng-if='vm.user'>
			<p class='lead text-success'>You are authenticated</p>
			<h3>Your session</h3>
			<pre><code>{{vm.user}}</code></pre>
			<div class='container'>
				<div class='col-xs-12 text-center'>
					<button class='btn btn-primary' ng-click='vm.logout()'>Logout</button>
				</div>
			</div>
		</div>

		<div class='modal fade' tabindex='-1' id='lostPasswordModal' role='dialog'>
			<div class='modal-dialog'>
				<div class='modal-content'>
					<div class='modal-header'>
						<button type='button' class='close' data-dismiss='modal'>
							<span>&times;</span>
						</button>
						<h4 class='modal-title'>Forgot your passsword?</h4>
					</div>
					<div class='modal-body'>
						<div class='form-group' ng-class='{"has-error": vm.lostPasswordErrors.email}'>
							<label class='control-label'>Please enter your email address</label>
							<input name='email' type='text' class='form-control' ng-model='vm.lostPasswordForm.email'>
							<span class='help-block' ng-repeat='err in vm.lostPasswordErrors.email'>
								{{err}}
							</span>
						</div>
					</div>
					<div class='modal-footer'>
						<button type='button' class='btn btn-default' data-dismiss='modal'>Cancel</button>
						<button type='button' class='btn btn-primary' ng-click='vm.lostPassword()'>Reset password</button>
					</div>
				</div>
			</div>
		</div>

		<div class='modal fade' tabindex='-1' id='resetPasswordModal'>
			<div class='modal-dialog'>
				<div class='modal-content'>
					<div class='modal-header'>
						<button type='button' class='close' data-dismiss='modal'>
							<span>&times;</span>
						</button>
						<h4 class='modal-title'>Reset your passsword</h4>
					</div>
					<div class='modal-body'>
						<div class='form-group' ng-class='{"has-error": vm.resetPasswordErrors.login}'>
							<label class='control-label'>Login</label>
							<input name='login' type='text' class='form-control' ng-model='vm.resetPasswordForm.login'>
							<span class='help-block' ng-repeat='err in vm.resetPasswordErrors.login'>
								{{err}}
							</span>
						</div>
						<div class='form-group' ng-class='{"has-error": vm.resetPasswordErrors.password1}'>
							<label class='control-label'>Password</label>
							<input name='password1' type='password' class='form-control' ng-model='vm.resetPasswordForm.password1'>
							<span class='help-block' ng-repeat='err in vm.resetPasswordErrors.password1'>
								{{err}}
							</span>
						</div>
						<div class='form-group' ng-class='{"has-error": vm.resetPasswordErrors.password2}'>
							<label class='control-label'>Repeat password</label>
							<input name='password2' type='password' class='form-control' ng-model='vm.resetPasswordForm.password2'>
							<span class='help-block' ng-repeat='err in vm.resetPasswordErrors.password2'>
								{{err}}
							</span>
						</div>

					</div>
					<div class='modal-footer'>
						<button type='button' class='btn btn-default' data-dismiss='modal'>Cancel</button>
						<button type='button' class='btn btn-primary' ng-click='vm.resetPassword()'>Reset password</button>
					</div>
				</div>
			</div>
		</div>

		<script src='//cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.5/angular.min.js'></script>
	    <script src='//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js'></script>
		<script src='//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js' integrity='sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa' crossorigin='anonymous'></script>
		<script src='/javascripts/ng-example.js'></script>
	</body>
</html>
